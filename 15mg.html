<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>15mg</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">

<style>
  :root { 
    --accent:#fa4238;
    --ticks-color:#cb007b;
    --green:#16a34a;
    --yellow:#ca8a04;
    --red:#dc2626;
    --black:#111827;
  }

  body{
    margin:0;
    font-family:'Cairo',sans-serif;
    background:#fff;
    display:flex;
    justify-content:center;
    min-height:100vh;
    font-size:16px;
  }

  .container{
    width:100%;
    max-width:720px;
    padding:16px;
    text-align:center;
  }

  .top-image img{
    width:100%;
    border-radius:22px;
    margin-bottom:22px;
    display:block;
  }

  .label{ color:#555; margin-bottom:6px; }

  .ticks{
    display:flex;
    flex-wrap:wrap;
    justify-content:center;
    gap:8px;
    margin:10px 0 14px;
  }

  .tick, .input-mini{
    padding:8px 14px;
    border-radius:10px;
    border:1px solid #ddd;
    background:#fff;
    color:var(--accent);
    cursor:pointer;
    font-family:'Cairo',sans-serif;
    box-sizing:border-box;
  }

  .tick.active{ color:#fff; }
  .tick.green{ background:var(--green); border-color:var(--green); }
  .tick.yellow{ background:var(--yellow); border-color:var(--yellow); }
  .tick.red{ background:var(--red); border-color:var(--red); }

  .input-mini{
    width:90px;
    cursor:text;
    text-align:center;
    outline:none;
  }

  .input-mini:focus{
    border-color:var(--accent);
    box-shadow:0 0 0 2px rgba(250,66,56,0.18);
  }

  .golden-wrap{
    display:flex;
    justify-content:center;
    gap:10px;
    margin:6px 0 14px;
    align-items:center;
  }

  .result{
    margin-top:20px;
    padding:18px;
    border:1px solid #ddd;
    border-radius:18px;
    background:#fafafa;
    font-size:22px;
    line-height:2;
    font-family:'Cairo',sans-serif;
  }

  .result *{ font-size:inherit; font-family:inherit; }

  .value{ font-weight:700; }
  .ticks-value{ color:var(--ticks-color); }

  .green{ color:var(--green); }
  .yellow{ color:var(--yellow); }
  .red{ color:var(--red); }
  .black{ color:var(--black); }

  .note{
    color:var(--red);
    font-weight:700;
    text-decoration:underline;
    margin-top:6px;
  }

  .interval-line{ margin:6px 0; }
</style>
</head>

<body>
<div class="container">

  <div class="top-image">
    <img src="https://www.mediafire.com/convkey/5055/395xn3p3vcs5eg89g.jpg" alt="Mounjaro 15">
  </div>

  <!-- عدد الأقلام -->
  <div class="label">عدد أقلام بالسنة (15mg)</div>
  <div class="ticks">
    <input class="input-mini" type="number" id="pensInput" min="1" value="3">
  </div>
  <div class="ticks" id="pensIcons"></div>

  <!-- الجرعة الذهبية -->
  <div class="golden-wrap">
    <input type="checkbox" id="goldenDose">
    <label for="goldenDose">استخدام الجرعة الذهبية</label>
  </div>

  <!-- الجرعة -->
  <div class="label">اختيار الجرعة (mg)</div>
  <div class="ticks">
    <input class="input-mini" type="number" id="mgManual" step="0.01" value="7.5">
  </div>
  <div class="ticks" id="doseIcons"></div>

  <!-- النتيجة -->
  <div class="result" id="output"></div>

</div>

<script>
  const pensIcons = document.getElementById("pensIcons");
  const doseIcons = document.getElementById("doseIcons");
  const pensInput = document.getElementById("pensInput");
  const mgManual = document.getElementById("mgManual");
  const goldenDose = document.getElementById("goldenDose");
  const output = document.getElementById("output");

  const PEN_PRICE = 103;
  const MG_MIN = 6;
  const MG_MAX = 10;

  // ✅ الافتراضي: 3 أقلام وجرعة 7.5mg
  let pens = 3;
  let selectedTicks = (7.5 / 15) * 60; // = 30

  function smartNumber(v, decimals = 2){
    if (v == null || !isFinite(v)) return "—";
    const s = Number(v).toFixed(decimals);
    return s.replace(/\.00$/, "").replace(/(\.\d*?[1-9])0+$/, "$1");
  }

  function intervalClass(v){
    if (v >= 7 && v < 18) return "green";
    if (v >= 18 && v <= 21) return "yellow";
    return "red";
  }

  function pensClass(p){
    if (p <= 3) return "green";
    if (p === 4) return "yellow";
    return "red";
  }

  function dosesColorClass(d){
    return d.toFixed(2).endsWith(".00") ? "green" : "black";
  }

  function ticksPerPen(){
    return goldenDose.checked ? 300 : 240;
  }

  function clear(group){
    group.querySelectorAll(".tick").forEach(t=>{
      t.classList.remove("active","green","yellow","red");
    });
  }

  function refreshDoseActiveColor(){
    const active = doseIcons.querySelector(".tick.active");
    if(!active) return;

    const mg = Number(active.dataset.mg);
    const totalTicks = ticksPerPen() * pens;
    const st = (mg / 15) * 60;
    const doses = totalTicks / st;
    const interval = 365 / doses;

    active.classList.remove("green","yellow","red");
    active.classList.add(intervalClass(interval));
  }

  /* أيقونات الأقلام */
  for(let i=1;i<=7;i++){
    const t=document.createElement("div");
    t.className="tick";
    t.textContent=i;

    t.onclick=()=>{
      clear(pensIcons);
      pens=i;
      pensInput.value=i;
      t.classList.add("active", pensClass(i));
      refreshDoseActiveColor();
      calculate();
    };

    pensIcons.appendChild(t);
  }

  /* أيقونات الجرعات */
  for(let mg=MG_MIN; mg<=MG_MAX+0.001; mg+=0.25){
    const t=document.createElement("div");
    t.className="tick";
    t.dataset.mg=mg.toFixed(2);
    t.textContent=mg.toFixed(2).replace(/\.00$/,"")+"mg";

    t.onclick=()=>{
      clear(doseIcons);
      mgManual.value = mg.toFixed(2).replace(/\.00$/,"");
      selectedTicks = (mg/15)*60;
      t.classList.add("active");
      refreshDoseActiveColor();
      calculate();
    };

    doseIcons.appendChild(t);
  }

  mgManual.addEventListener("input",()=>{
    const mg = Number(mgManual.value);
    selectedTicks = mg>0 ? (mg/15)*60 : 0;

    clear(doseIcons); // يدوي = لا يوجد أيقونة مفعلة
    calculate();
  });

  goldenDose.addEventListener("change",()=>{
    refreshDoseActiveColor();
    calculate();
  });

  pensInput.addEventListener("input",()=>{
    pens = Number(pensInput.value) || 0;
    clear(pensIcons);
    refreshDoseActiveColor();
    calculate();
  });

  function calculate(){
    if(!(pens>0 && selectedTicks>0)){
      output.innerHTML = `
        عدد الأقلام في السنة: <span class="value">—</span><br>
        عدد التكات: <span class="value">—</span><br>
        مجموع عدد الجرعات: <span class="value">—</span><br>
        <div class="interval-line">
          الفاصل بين الجرعات كل <span class="value">—</span> يوم
        </div>
        <div class="note">فاصل الجرعة المناسب لتثبيت الوزن من 7 - 17 يوم</div>
        إجمالي تكلفة الاقلام كل سنة (KWD): <span class="value">—</span>
      `;
      return;
    }

    const totalTicks = ticksPerPen() * pens;
    const doses = totalTicks / selectedTicks;
    const interval = 365 / doses;

    output.innerHTML = `
      عدد الأقلام في السنة:
      <span class="value ${pensClass(pens)}">${pens}</span><br>
      عدد التكات:
      <span class="value ticks-value">${smartNumber(selectedTicks, 2)}</span><br>
      مجموع عدد الجرعات:
      <span class="value ${dosesColorClass(doses)}">${smartNumber(doses, 2)}</span><br>
      <div class="interval-line">
        الفاصل بين الجرعات كل
        <span class="value ${intervalClass(interval)}">${smartNumber(interval, 2)}</span> يوم
      </div>
      <div class="note">فاصل الجرعة المناسب لتثبيت الوزن من 7 - 17 يوم</div>
      إجمالي تكلفة الاقلام كل سنة (KWD):
      <span class="value">${(pens * PEN_PRICE).toFixed(2)}</span>
    `;
  }

  window.addEventListener("DOMContentLoaded",()=>{
    // تفعيل أيقونة قلم 3
    const p3 = Array.from(pensIcons.querySelectorAll(".tick")).find(x => x.textContent === "3");
    if(p3) p3.classList.add("active", pensClass(3));

    // تفعيل أيقونة 7.5mg
    const d75 = Array.from(doseIcons.querySelectorAll(".tick")).find(x => Number(x.dataset.mg) === 7.5);
    if(d75){
      d75.classList.add("active");
      refreshDoseActiveColor();
    }

    calculate();
  });
</script>

</body>
</html>
